# Yolo系列

### Yolo-v1

部分参考了：http://blog.pointborn.com/article/2022/1/19/1782.html

摘要：yolo是one stage的网络，直接生成目标的位置和类别

优点：快。

缺点：对小目标效果不太好，yolov1的每个cell只能负责预测一个类别。



正文：

图片缩放到448 * 448，然后将图片分为7*7的小格。

每个格子需要预测B个框（论文里面是B=2），C个类别，需要注意的是如果一个网格当中出现了两个物体的中心，或者一个网格中包含了很多个小物体，那么YOLO算法仅能够检测出一个类别的一个物体，所以YOLO对靠的很近的物体以及小目标的检测表现不是特别好。

> 这里举个例子，假设我们的数据集有20个类别的数据，我们使用2个boundingbox（b=2），基于7*7的格子，我们最后输出的tensor应该是：7 * 7 * 2 * 5 + 7 * 7 * 20 = 7 * 7 * 30

网络结构：

整个网络是一个端到端的网络，其整体的网络结构参考了GooLeNet的结构：

![img](https://img-blog.csdnimg.cn/20200811145153575.png#pic_center)

损失函数部分的分析：

![img](https://img-blog.csdnimg.cn/20200811150352478.png#pic_center)

- 第一部分为中心点损失，即为边界框中心坐标的误差项，1ijobj 指的是第 i 个单元格存在目标，且该单元格中的第 j 个边界框负责预测该目标；
- 第二部分为宽高损失项，即为边界框的高与宽的误差项；
- 第三部分为置信度损失项，由包含目标边界框的置信度误差项和不包含目标的边界框的置信度误差项组成；
- 最后一部分为类别损失，表示包含目标的单元格的分类误差项，1iobj 指第 i 个单元格存在目标。

在这里的两个超参数coord=5，noobj=0.5。

> 网络预测多个边界框，最后也使用了NMS